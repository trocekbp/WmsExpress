@using WmsCore.Data
@model IEnumerable<Category>

@{
    ViewData["Title"] = "Index";
    int currentID = (int?)ViewData["CurrentID"] ?? 0;
}

<h1>Atrybuty</h1>

@foreach (var cat in Model)
{
    <div class="border-bottom p-2">

        <button class="btn btn-primary @(cat.CategoryId == currentID ? "" : "collapsed")"
                type="button"
                data-bs-toggle="collapse"
                data-bs-target="#szczegoly-@cat.CategoryId"
                aria-expanded="@(cat.CategoryId == currentID ? "true" : "false")">
            @cat.Name
        </button>

        <div class="collapse @(cat.CategoryId == currentID ? "show" : "") ms-5" id="szczegoly-@cat.CategoryId">
            <div class="mt-3">
                @foreach (var def in cat.AtrDefinitions)
                {
                    <div class="border rounded-pill shadow-sm mb-3 bg-white p-2 kapsulka-hover">

                        <div class="row align-items-center g-0">

                            <div class="col-2 ps-4 fw-bold  text-truncate">
                                @def.Name
                            </div>

                            <div class="col-1">
                                <a class="btn btn-sm btn-outline-primary w-100 rounded-pill"
                                   asp-action="Edit"
                                   asp-route-id="@def.AtrDefinitionId">
                                    Edycja
                                </a>
                            </div>

                            <div class="col-1 d-flex justify-content-center">
                                <a asp-action="Delete"
                                   asp-route-id="@def.AtrDefinitionId"
                                    class="btn-small-delete" aria-label="Usuń element"></a>
                            </div>

                            <div class="col-1 text-center text-secondary small fw-bold text-uppercase">
                                Wartości:
                            </div>

                            <div class="col pe-4">
                                @foreach (var attr in def.Attributes)
                                {
                                    <span class="badge bg-light text-dark border me-1">
                                        @attr.Value
                                    </span>
                                }
                            </div>

                        </div>
                    </div>
                  
                }
                <a asp-action="Create"
                asp-route-CurrentID="@cat.CategoryId"
                   class="d-block text-decoration-none border border-success border-opacity-25 rounded-pill shadow-sm mb-3 bg-white p-2 kapsulka-hover text-center text-success fw-bold">
                    <div class="row align-items-center g-0">
                        <div class="col">
                            <i class="bi bi-plus-circle me-2"></i>
                            Dodaj definicję
                        </div>
                    </div>
                </a>
            </div>
        </div>

    </div>
}
